Here are some complex SQL prompts you can try:

## Complex Analytical Queries:

1. **Multi-table aggregation with window functions:**
   ```
   Show me the top 5 customers by total revenue in each region, along with their average order value and how they rank compared to other customers in their region
   ```

2. **Cohort analysis:**
   ```
   Calculate the monthly retention rate for customers who made their first purchase in 2023, showing what percentage came back to purchase in each subsequent month
   ```

3. **Recursive hierarchy:**
   ```
   Display the complete organizational chart showing all employees under the VP of Sales, including their reporting chain, level in the hierarchy, and total number of subordinates
   ```

4. **Complex time-series analysis:**
   ```
   Find products where sales declined for 3 consecutive months but inventory levels increased, along with the percentage change and current stock-to-sales ratio
   ```

5. **Advanced filtering with subqueries:**
   ```
   List all customers who purchased from at least 3 different product categories, spent more than the average customer lifetime value, but haven't made a purchase in the last 60 days
   ```

6. **Pivot-style aggregation:**
   ```
   Create a report showing monthly sales by product category for the last year, with columns for each month and rows for each category, including year-over-year growth percentages
   ```

7. **Self-join pattern matching:**
   ```
   Find all order pairs where the same customer ordered the same product twice within 7 days, showing the time difference and whether the second order was larger or smaller
   ```

8. **Statistical analysis:**
   ```
   Calculate the correlation between marketing spend and revenue by channel for each quarter, identifying channels with declining ROI and those outperforming the median
   ```

These should generate some interesting SQL with JOINs, CTEs, window functions, subqueries, and complex aggregations!
